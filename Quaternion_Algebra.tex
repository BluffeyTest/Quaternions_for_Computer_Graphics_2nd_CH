
\chap{四元数代数}
\section{介绍}
本章包含进一步的历史背景，四元数的发明，并涵盖四元数代数的演变。我展示了如何通过将四元数视为有序对来极大地简化四元数代数，并提供了加法、减法、实数、纯四元数和单位四元数的示例。在定义了复共轭、范数、四元数积、平方和逆之后，我将展示如何用矩阵表示四元数。本章最后总结了重要的定义和几个工作实例。



\section{一些历史}
Hamilton 定义了一个四元数$q$，它的相关规则为
$$
    q=s+i a+j b+k c, \quad s, a, b, c \in \mathbb{R}
$$
其中，
$$
    \begin{gathered}
        i^{2}=j^{2}=k^{2}=i j k=-1 \\
        i j=k, \quad j k=i, \quad k i=j \\
        j i=-k, k j=-i, i k=-j
    \end{gathered}
$$
引用\cite{bib6-1,bib6-2,bib6-3} 但我们倾向于将四元数写成
$$
    q=s+a i+b j+c k
$$
从 Hamilton 的规则中观察$i  j$的出现是如何被$k$所取代的。额外的虚数k项是循环模式$i j=k, j k=i$和$k i=j$的关键，它们非常类似于两个单位笛卡尔矢量的叉乘:
$$
    \mathbf{i} \times \mathbf{j}=\mathbf{k}, \quad \mathbf{j} \times \mathbf{k}=\mathbf{i}, \quad \mathbf{k} \times \mathbf{i}=\mathbf{j} .
$$
事实上，这种相似性并非巧合，因为 Hamilton 也发明了标量和向量乘积。然而，尽管四元数提供了一个描述向量的代数框架，人们必须承认，在 Hamilton 之前，向量已经被研究了很多年。

Hamilton 还发现$i, j, k$项可以表示三个笛卡尔单位向量$\mathbf{i}, \mathbf{j}$和$\mathbf{k}$，它们必须具有虚数性质。例如$\mathbf{i}^{2}=-1$，等等，这对于一些数学家和科学家来说不太好，他们怀疑是否有必要涉及这么多虚项。

Hamilton 寻找复数的三维等效物的动机部分是代数的，部分是几何的。因为如果一个复数是由有序对表示的，并且能够以$90^{\circ}$旋转平面上的点，那么也许一个三元组可以以$90^{\circ}$旋转空间中的点。最后，一个三元组必须被一个四元组-一个四元数取代。

我们可以从两个角度来看待 Hamilton 的规则。首先，它们是三个虚项组合的代数结果。第二，它们反映了一个潜在的空间几何结构。后一种解释被P. G. Tait(p.g.泰特)所采用，并在他的《四元数的基本论述》一书中进行了概述。Tait的方法假设三个单位向量$\mathbf{i}, \mathbf{j}$, $\mathbf{k}$分别与$x$-， $y$-， $z$-轴对齐:

\begin{CJK}{UTF8}{gkai}
    $\mathbf{i}$与$\mathbf{j}$相乘的结果或$\mathbf{ij}$定义为$\mathbf{j}$在垂直于$\mathbf{i}$的平面上沿正方向转动一个直角，换句话说，$\mathbf{i}$对$\mathbf{j}$的操作将其翻转过来，使其与$\mathbf{k}$重合;因此简而言之$\mathbf{i} \mathbf{j}=\mathbf{k}$。

    为了保持一致，必须承认，如果$\mathbf{i}$不是对$\mathbf{j}$进行操作，而是对平面$y z$中垂直于$\mathbf{i}$的任何其他单位向量进行操作，它将使其在同一方向上经过一个直角，因此$\mathbf{i k}$只能是$-\mathbf{j}$。

    将我们引用$\mathbf{i}$来说明的定义扩展到其他单位向量，很明显，$\mathbf{j}$对$\mathbf{k}$的运算必须使其转回$\mathbf{i}$，或$\mathbf{j} \mathbf{k}=\mathbf{i}$。\cite{bib6-4}
\end{CJK}

其解释如图\ref{fig:6-1} a-d所示。图\ref{fig:6-1}a显示了 $\mathbf{i}$， $\mathbf{j}$， $\mathbf{k}$的原始对齐方式。图\ref{fig:6-1}b显示了 $\mathbf{j}$ 转动 $\mathbf{k}$ 的效果。图\ref{fig:6-1}c显示了 $\mathbf{k}$ 转动 $\mathbf{i}$，图6.1d显示了 $\mathbf{i}$ 转动 $\mathbf{j}$。

\begin{figure}[htbp]
    \centering
    \subfigure[]{\includegraphics[max width=0.3\textwidth]{2023_04_20_41f1ceac5a31dc7d1b59g-089(1)}}
    \subfigure[]{\includegraphics[max width=0.3\textwidth]{2023_04_20_41f1ceac5a31dc7d1b59g-089(2)}}\\
    \subfigure[]{\includegraphics[max width=0.3\textwidth]{2023_04_20_41f1ceac5a31dc7d1b59g-089}}
    \subfigure[]{\includegraphics[max width=0.3\textwidth]{2023_04_20_41f1ceac5a31dc7d1b59g-089(3)}}
    \caption[short]{ 解释乘积$\mathbf{j k,  ki, ij}$}
    \label{fig:6-1}
\end{figure}


到目前为止，还没有提到虚数——我们只有:
$$
    \begin{aligned}
         & \mathbf{i j}=\mathbf{k}, \quad \mathbf{j k}=\mathbf{i}, \quad \mathbf{k i}=\mathbf{j} \\
         & \mathbf{j i}=-\mathbf{k}, \mathbf{k j}=-\mathbf{i}, \mathbf{i k}=-\mathbf{j} .
    \end{aligned}
$$

如果我们假设这些向量服从代数的分配律和结合律，它们的虚性质就暴露出来了。例如:
$$
    \mathbf{i j}=\mathbf{k}
$$

然后以$\mathbf{i}$相乘:
$$
    \mathbf{i i j}=\mathbf{i k}=-\mathbf{j}
$$

因此，
$$
    \mathbf{i i}=\mathbf{i}^{2}=-1
$$

同样，我们可以展示 $\mathbf{j}^{2}=\mathbf{k}^{2}=-1$.

接下来:

$$
    \mathbf{i} \mathbf{j} \mathbf{k}=\mathbf{i}(\mathbf{j} \mathbf{k})=\mathbf{i} \mathbf{i}=\mathbf{i}^{2}=-1
$$

因此，仅仅通过声明叉积的作用， Hamilton 的规则就出现了，带有所有虚数的特征。它还提出了下列意见:

\begin{CJK}{UTF8}{gkai}
    Servois 于 1813 年在热尔贡（Gergonne）的《年鉴》上发表了一个非常奇特的推测，这是迄今为止发现的唯一一个包含有对四元数的最微小的预想痕迹的推测。 为了把平面的$a+b \sqrt{-1}$形式推广到空间，他通过类比写出了空间有向单位线的形式
    $$
        p \cos \alpha+q \cos \beta+r \cos \gamma
    $$

    在这里，$\alpha, \beta, \gamma$分别是它对三个轴的倾斜角。他很容易意识到$p, q, r$必须是非实数：但是，他问道，“它们是否可以化简为一般形式 $A+B\sqrt{-1}$？” 这不可能是答案。事实上，它们就是四元数微积分中的 $\mathbf{i}, \mathbf{j}, \mathbf{k}$。\cite{bib6-4}

\end{CJK}

因此，法国数学家弗朗索瓦-约瑟夫·塞尔瓦（François-Joseph Servois,1768-1847）也曾非常接近发现四元数。此外， Tait 和 Hamilton 显然都不知道 Rodrigues 发表的论文。

而且还不止于此。杰出的德国数学家卡尔·弗里德里希·高斯(Carl Friedrich Gauss, 1777-1855)非常谨慎，对发表任何过于革命性的东西都感到紧张，以防他被同行的数学家嘲笑。他的日记显示，他比尼古拉·伊万诺维奇·罗巴切夫斯基(Nikolai Ivanovich Lobachevsky)更早发现了非欧几里得几何。1819年，他在日记中的一个简短笔记中\cite{bib6-5}透露，他已经确定了一种求两个四元数$(a, b, c, d)$和$(\alpha, \beta, \gamma, \delta)$乘积的方法:
$$
    \begin{aligned}
        (A, B, C, D)= & (a, b, c, d)(\alpha, \beta, \gamma, \delta)                               \\
        =             & (a \alpha-b \beta-c \gamma-d \delta, a \beta+b \alpha-c \delta+d \gamma   \\
                      & a \gamma+b \delta+c \alpha-d \beta, a \delta-b \gamma+c \beta+d \alpha) .
    \end{aligned}
$$
乍一看，这个结果看起来不像四元数乘积，但如果我们将四元数的第二个和第三个坐标转置，并将它们视为四元数，我们有:

$$
    \begin{aligned}
        (A, B, C, D) & =(a+c i+b j+d k)(\alpha+\gamma i+\beta j+\delta k)                                    \\
                     & =a \alpha-c \gamma-b \beta-d \delta+a(\gamma i+\beta j+\delta k)                      \\
                     & =+\alpha(c i+b j+d k),(b \delta-d \beta) i+(d \gamma-c \delta) j+(c \beta-b \gamma) k
    \end{aligned}
$$
这和 Hamilton 的四元数乘积是一样的!此外， Gauss 还意识到乘积是不可交换的。然而，他没有发表他的发现，而是让 Hamilton 自己发明了四元数，发表了他的结果，并获得了荣誉。

在1881年和1884年，耶鲁大学的约西亚·威拉德·吉布斯(Josiah Willard Gibbs)为他的学生印刷了他关于矢量分析的课堂笔记。吉布斯切断了四元数的实部和矢量部之间的“脐带”，并将三维矢量作为一个独立的对象提出，没有任何虚数的内涵。 Gibbs 还采纳了德国数学家赫尔曼·格莱斯曼(Hermann Günter Grassmann, 1809-1877)的思想，后者自1832年以来一直在发展自己的向量系统思想。Gibbs 还使用四元数乘积的相关部分定义了标量和向量乘积。最后，在1901年， Gibbs 的学生埃德温·比德威尔·威尔逊(Edwin Bidwell Wilson)以书的形式出版了吉布斯的笔记:《矢量分析》\cite{bib6-6}，其中包含了今天使用的符号。

四元数代数无疑是虚数，然而，仅仅通过分离矢量部分并忽略虚数规则， Gibbs 就揭示了数学的一个新分支，即矢量分析。Hamilton 和他的支持者无法说服同行四元数可以表示矢量，最终， Gibbs 的符号赢得了胜利，四元数也逐渐淡出了人们的视野。

近年来，四元数被飞行模拟行业重新发现，最近又被计算机图形学界重新发现，并被用于围绕任意轴旋转矢量。在此期间，许多人都有机会对四元数进行研究，并提出了利用其特性的新方法。


让我们看看四元数 $q$ 的三种写法:
\begin{align}
    q= & s+x i+y j+z k                                                                        \\
    q= & s+\mathbf{v}                                                                         \\
    q= & {[s, \mathbf{v}] }                                                                   \\
       & \text { 其中 } s, x, y, z \in \mathbb{R}, \quad \mathbf{v} \in \mathbb{R}^{3} \notag \\
       & \text { 和 } i^{2}=j^{2}=k^{2}=-1 .\notag
\end{align}

区别是相当微妙的。在(6.1)中，我们有 Hamilton 的原始定义及其虚数术语和相关规则。在(6.2)中，' $+$ '符号用于向向量添加标量，这看起来很奇怪，但却有效。在(6.3)中，我们有一个由标量和向量组成的有序对。

现在你可能会想:同一个物体怎么可能有三种不同的定义?我认为你可以随便叫一个对象，只要它们在代数上是相同的。例如，用矩阵表示法表示一组线性式，得到的结果与普通式相同。因此，两种表示法是同样有效的。

虽然我在其他出版物中使用了(6.1)和(6.2)中的符号，但在本书中我使用的是有序对。因此，我们需要证明的是， Hamilton 对四元数的原始定义(6.1)，包括它的标量和三个虚数项，可以被一个由标量和一个“现代”向量组成的有序对(6.3)所取代。

\section{四元数定义}

让我们从两个四元数$q_{a}$和$q_{b}$ à la Hamilton开始:\footnote{译注，原句是：Let's start with two quaternions $q_{a}$ and $q_{b}$ à la Hamilton:，感觉原句有错误排过来的字符。 }

$$
    \begin{aligned}
         & q_{a}=s_{a}+x_{a} i+y_{a} j+z_{a} k \\
         & q_{b}=s_{b}+x_{b} i+y_{b} j+z_{b} k
    \end{aligned}
$$
和强制性规则：
$$
    \begin{gathered}
        i^{2}=j^{2}=k^{2}=i j k=-1 \\
        i j=k, \quad j k=i, \quad k i=j \\
        j i=-k, k j=-i, i k=-j .
    \end{gathered}
$$
我们的目标是证明 $q_{a}$ 和 $q_{b}$ 也可以用有序对来表示
$$
    \begin{aligned}
        q_{a} & =\left[s_{a}, \mathbf{a}\right]                                                                                       \\
        q_{b} & =\left[s_{b}, \mathbf{b}\right], \quad s_{a}, s_{b} \in \mathbb{R}, \quad \mathbf{a}, \mathbf{b} \in \mathbb{R}^{3} .
    \end{aligned}
$$
四元数乘积 $q_{a} q_{b}$ 展开为
\begin{align}
    \begin{aligned}
        q_{a} q_{b}=\left[s_{a}, \mathbf{a}\right]\left[s_{b}, \mathbf{b}\right]= & {\left[s_{a}+x_{a} i+y_{a} j+z_{a} k\right]\left[s_{b}+x_{b} i+y_{b} j+z_{b} k\right] } \\
        =                                                                         & {\left[\left(s_{a} s_{b}-x_{a} x_{b}-y_{a} y_{b}-z_{a} z_{b}\right)\right.}             \\
                                                                                  & +\left(s_{a} x_{b}+s_{b} x_{a}+y_{a} z_{b}-y_{b} z_{a}\right) i                         \\
                                                                                  & +\left(s_{a} y_{b}+s_{b} y_{a}+z_{a} x_{b}-z_{b} x_{a}\right) j                         \\
                                                                                  & \left.+\left(s_{a} z_{b}+s_{b} z_{a}+x_{a} y_{b}-x_{b} y_{a}\right) k\right] .
    \end{aligned}
    \label{ep:6.4}
\end{align}

式 (6.4) 采用了另一种四元数的形式，证实了四元数乘积是封闭的。

在这个阶段， Hamilton 把虚项 $i,j,k$ 转化为单位直角坐标向量 $\mathbf{i}, \mathbf{j}, \mathbf{k}$ 并把 (6.4) 转化为向量形式。这种方法的问题在于向量保留了它们的虚根。Simon Altmann 的建议是用有序对代替虚数：
$$
    i=[0, \mathbf{i}], \quad j=[0, \mathbf{j}], \quad k=[0, \mathbf{k}]
$$
它们本身就是四元数，叫做四元数单位。

用四元数单位来定义一个四元数和用单位笛卡尔向量来定义一个向量是完全一样的。此外，它允许向量在没有任何想象关联的情况下存在。

让我们将这些四元数单位与 $[1, \mathbf{0}]=1$ 一起代入 (6.4) 中：

\begin{align}
    \begin{aligned}
        {\left[s_{a}, \mathbf{a}\right]\left[s_{b}, \mathbf{b}\right]=} & {\left[\left(s_{a} s_{b}-x_{a} x_{b}-y_{a} y_{b}-z_{a} z_{b}\right)[1, \mathbf{0}]\right.}  \\
                                                                        & +\left(s_{a} x_{b}+s_{b} x_{a}+y_{a} z_{b}-y_{b} z_{a}\right)[0, \mathbf{i}]                \\
                                                                        & +\left(s_{a} y_{b}+s_{b} y_{a}+z_{a} x_{b}-z_{b} x_{a}\right)[0, \mathbf{j}]                \\
                                                                        & \left.+\left(s_{a} z_{b}+s_{b} z_{a}+x_{a} y_{b}-x_{b} y_{a}\right)[0, \mathbf{k}]\right] .
    \end{aligned}
\end{align}
接下来，我们利用之前定义的规则展开 (6.5)：
\begin{align}
    \begin{aligned}
        {\left[s_{a}, \mathbf{a}\right]\left[s_{b}, \mathbf{b}\right]=} & {\left[\left[s_{a} s_{b}-x_{a} x_{b}-y_{a} y_{b}-z_{a} z_{b}, \mathbf{0}\right]\right.}                \\
                                                                        & +\left[0,\left(s_{a} x_{b}+s_{b} x_{a}+y_{a} z_{b}-y_{b} z_{a}\right) \mathbf{i}\right]                \\
                                                                        & +\left[0,\left(s_{a} y_{b}+s_{b} y_{a}+z_{a} x_{b}-z_{b} x_{a}\right) \mathbf{j}\right]                \\
                                                                        & \left.+\left[0,\left(s_{a} z_{b}+s_{b} z_{a}+x_{a} y_{b}-x_{b} y_{a}\right) \mathbf{k}\right]\right] .
    \end{aligned}
\end{align}
纵向扫描 (6.6) 可以发现一些隐藏向量：
\begin{align}
    \begin{aligned}
        {\left[s_{a}, \mathbf{a}\right]\left[s_{b}, \mathbf{b}\right]=} & {\left[\left[s_{a} s_{b}-x_{a} x_{b}-y_{a} y_{b}-z_{a} z_{b}, \mathbf{0}\right]\right.}                                                                                      \\
                                                                        & +\left[0, s_{a}\left(x_{b} \mathbf{i}+y_{b} \mathbf{j}+z_{b} \mathbf{k}\right)+s_{b}\left(x_{a} \mathbf{i}+y_{a} \mathbf{j}+z_{a} \mathbf{k}\right)\right.                   \\
                                                                        & \left.\left.+\left(y_{a} z_{b}-y_{b} z_{a}\right) \mathbf{i}+\left(z_{a} x_{b}-z_{b} x_{a}\right) \mathbf{j}+\left(x_{a} y_{b}-x_{b} y_{a}\right) \mathbf{k}\right]\right] .
    \end{aligned}
\end{align}
式 (6.7) 包含两个有序对，现在可以将它们合并起来：
\begin{align}
    \begin{aligned}
        {\left[s_{a}, \mathbf{a}\right]\left[s_{b}, \mathbf{b}\right]=} & {\left[s_{a} s_{b}-x_{a} x_{b}-y_{a} y_{b}-z_{a} z_{b},\right.}                                                                                                 \\
                                                                        & +s_{a}\left(x_{b} \mathbf{i}+y_{b} \mathbf{j}+z_{b} \mathbf{k}\right)+s_{b}\left(x_{a} \mathbf{i}+y_{a} \mathbf{j}+z_{a} \mathbf{k}\right)                      \\
                                                                        & \left.+\left(y_{a} z_{b}-y_{b} z_{a}\right) \mathbf{i}+\left(z_{a} x_{b}-z_{b} x_{a}\right) \mathbf{j}+\left(x_{a} y_{b}-x_{b} y_{a}\right) \mathbf{k}\right] .
    \end{aligned}
\end{align}
如果我们令
$$
    \begin{aligned}
         & \mathbf{a}=x_{a} \mathbf{i}+y_{a} \mathbf{j}+z_{a} \mathbf{k} \\
         & \mathbf{b}=x_{b} \mathbf{i}+y_{b} \mathbf{j}+z_{b} \mathbf{k}
    \end{aligned}
$$

将它们代入 (6.8) 即可得：

\begin{align}
    \left[s_{a}, \mathbf{a}\right]\left[s_{b}, \mathbf{b}\right]=\left[s_{a} s_{b}-\mathbf{a} \cdot \mathbf{b}, s_{a} \mathbf{b}+s_{b} \mathbf{a}+\mathbf{a} \times \mathbf{b}\right]
\end{align}
它定义了四元数乘积。

从现在开始，我们不必担心 Hamilton 的规则，因为它们嵌入在挨(6.9)中。此外，我
们的向量没有虚数的关联。

虽然 Rodrigues 没有使用(6.9)中使用的 Gibbs 向量符号，但他设法计算出等效的代数
表达式，这是一项成就。

\subsection{四元数单位}
使用(6.9)，我们可以通过对四元数单位进行平方来检查四元数单位是否为虚数:
$$
    \begin{aligned}
        i     & =[0, \mathbf{i}]                                             \\
        i^{2} & =[0, \mathbf{i}][0, \mathbf{i}]                              \\
              & =[\mathbf{i} \cdot \mathbf{i}, \mathbf{i} \times \mathbf{i}] \\
              & =[-1, \mathbf{0}]
    \end{aligned}
$$

which is a real quaternion and equivalent to -1 , confirming that $[0, \mathbf{i}]$ is imaginary. Using a similar expansion we can shown that $[0, \mathbf{j}]$ and $[0, \mathbf{k}]$ have the same property. Now let's compute the products $i j, j k$ and $k i$ :

$$
    \begin{aligned}
        i j & =[0, \mathbf{i}][0, \mathbf{j}]                               \\
            & =[-\mathbf{i} \cdot \mathbf{j}, \mathbf{i} \times \mathbf{j}] \\
            & =[0, \mathbf{k}]
    \end{aligned}
$$

which is the quaternion unit $k$.

$$
    \begin{aligned}
        j k & =[0, \mathbf{j}][0, \mathbf{k}]                               \\
            & =[-\mathbf{j} \cdot \mathbf{k}, \mathbf{j} \times \mathbf{k}] \\
            & =[0, \mathbf{i}]
    \end{aligned}
$$

which is the quaternion unit $i$.

$$
    \begin{aligned}
        k i & =[0, \mathbf{k}][0, \mathbf{i}]                               \\
            & =[-\mathbf{k} \cdot \mathbf{i}, \mathbf{k} \times \mathbf{i}] \\
            & =[0, \mathbf{j}]
    \end{aligned}
$$

which is the quaternion unit $j$.

Next, let's confirm that $i j k=-1$ :

$$
    \begin{aligned}
        \text { ijk } & =[0, \mathbf{i}][0, \mathbf{j}][0, \mathbf{k}]                \\
                      & =[0, \mathbf{k}][0, \mathbf{k}]                               \\
                      & =[-\mathbf{k} \cdot \mathbf{k}, \mathbf{k} \times \mathbf{k}] \\
                      & =[-1, \mathbf{0}]
    \end{aligned}
$$

which is a real quaternion equivalent to -1 , confirming that $i j k=-1$.

Thus the notation of ordered pairs upholds all of Hamilton's rules. However, the last double product assumes that quaternions are associative. So let's double check to show that $(i j) k=i(j k)$ :

$$
    \begin{aligned}
        i(j k) & =[0, \mathbf{i}][0, \mathbf{j}][0, \mathbf{k}]                \\
               & =[0, \mathbf{i}][0, \mathbf{i}]                               \\
               & =[-\mathbf{i} \cdot \mathbf{i}, \mathbf{i} \times \mathbf{i}] \\
               & =[-1, \mathbf{0}]
    \end{aligned}
$$

which is correct.

\subsection{四元数乘积示例}
Although we have yet to discover how quaternions are used to rotate vectors, let's concentrate on their algebraic traits by evaluating an example.

$$
    \begin{aligned}
         & q_{a}=[1,2 \mathbf{i}+3 \mathbf{j}+4 \mathbf{k}] \\
         & q_{b}=[2,3 \mathbf{i}+4 \mathbf{j}+5 \mathbf{k}]
    \end{aligned}
$$

the product $q_{a} q_{b}$ is

$$
    \begin{aligned}
        q_{a} q_{b}= & {[1,2 \mathbf{i}+3 \mathbf{j}+4 \mathbf{k}][2,3 \mathbf{i}+4 \mathbf{j}+5 \mathbf{k}] }                    \\
        =            & {[1 \times 2-(2 \times 3+3 \times 4+4 \times 5),}                                                          \\
                     & 1(3 \mathbf{i}+4 \mathbf{j}+5 \mathbf{k})+2(2 \mathbf{i}+3 \mathbf{j}+4 \mathbf{k})                        \\
                     & +(3 \times 5-4 \times 4) \mathbf{i}-(2 \times 5-4 \times 3) \mathbf{j}+(2 \times 4-3 \times 3) \mathbf{k}] \\
        =            & {[-36,7 \mathbf{i}+10 \mathbf{j}+13 \mathbf{k}-\mathbf{i}+2 \mathbf{j}-\mathbf{k}] }                       \\
        =            & {[-36,6 \mathbf{i}+12 \mathbf{j}+12 \mathbf{k}] }
    \end{aligned}
$$

which is another ordered pair representing a quaternion.

Having shown that Hamilton's imaginary notation has a vector equivalent, and can be represented as an ordered pair, we continue with this notation and describe other features of quaternions. Note that we can abandon Hamilton's rules as they are embedded within the definition of the quaternion product, and will surface in the following definitions.

\section{代数定义}
A quaternion is the ordered pair:

$$
    q=[s, \mathbf{v}], \quad s \in \mathbb{R}, \quad \mathbf{v} \in \mathbb{R}^{3}
$$

If we express $\mathbf{v}$ in terms of its components, we have

$$
    q=[s, x \mathbf{i}+y \mathbf{j}+z \mathbf{k}], \quad s, x, y, z \in \mathbb{R}
$$

\section{四元数加减法}
Addition and subtraction employ the following rule:

$$
    \begin{aligned}
        q_{a}           & =\left[s_{a}, \mathbf{a}\right]                            \\
        q_{b}           & =\left[s_{b}, \mathbf{b}\right]                            \\
        q_{a} \pm q_{b} & =\left[s_{a} \pm s_{b}, \mathbf{a} \pm \mathbf{b}\right] .
    \end{aligned}
$$

For example:

$$
    \begin{aligned}
        q_{a}       & =[0.5,2 \mathbf{i}+3 \mathbf{j}-4 \mathbf{k}]   \\
        q_{b}       & =[0.1,4 \mathbf{i}+5 \mathbf{j}+6 \mathbf{k}]   \\
        q_{a}+q_{b} & =[0.6,6 \mathbf{i}+8 \mathbf{j}+2 \mathbf{k}]   \\
        q_{a}-q_{b} & =[0.4,-2 \mathbf{i}-2 \mathbf{j}-10 \mathbf{k}]
    \end{aligned}
$$

\section{实四元数}
A real quaternion has a zero vector term:

$$
    q=[s, \mathbf{0}]
$$

The product of two real quaternions is

$$
    \begin{aligned}
        q_{a}       & =\left[s_{a}, \mathbf{0}\right]                               \\
        q_{b}       & =\left[s_{b}, \mathbf{0}\right]                               \\
        q_{a} q_{b} & =\left[s_{a}, \mathbf{0}\right]\left[s_{b}, \mathbf{0}\right] \\
                    & =\left[s_{a} s_{b}, \mathbf{0}\right]
    \end{aligned}
$$

which is another real quaternion, and shows that they behave just like real numbers:

$$
    [s, \mathbf{0}] \equiv s
$$

We have already come across this with complex numbers containing a zero imaginary term:

$$
    a+b i=a, \quad \text { when } b=0
$$

\section{四元数乘以标量}
Intuition suggests that multiplying a quaternion by a scalar should obey the rule:

$$
    \begin{aligned}
        q         & =[s, \mathbf{v}]                                      \\
        \lambda q & =\lambda[s, \mathbf{v}], \quad \lambda \in \mathbb{R} \\
                  & =[\lambda s, \lambda \mathbf{v}] .
    \end{aligned}
$$

For example:

$$
    \begin{aligned}
        q & =3[2,3 \mathbf{i}+4 \mathbf{j}+5 \mathbf{k}]    \\
          & =[6,9 \mathbf{i}+12 \mathbf{j}+15 \mathbf{k}] .
    \end{aligned}
$$

We can confirm our intuition by multiplying a quaternion by a scalar in the form of a real quaternion:

$$
    \begin{aligned}
        q         & =\left[\begin{array}{ll}
                s, & \mathbf{v}
            \end{array}\right]                \\
        \lambda   & =[\lambda, \mathbf{0}]                                  \\
        \lambda q & =\left[\begin{array}{ll}
                \lambda, & \mathbf{0}
            \end{array}\right][s, \mathbf{v}] \\
                  & =\left[\begin{array}{ll}
                \lambda s, & \lambda \mathbf{v}
            \end{array}\right]
    \end{aligned}
$$

which is excellent confirmation.

\section{纯四元数}
Hamilton defined a pure quaternion as one having a zero scalar term:

$$
    q=x i+y j+z k
$$

and is just a vector, but with imaginary qualities. Simon Altmann, and others, believe that this was a serious mistake on Hamilton's part to call a quaternion with a zero real term, a vector.

The main issue is that there are two types of vectors: polar and axial, also called a pseudovector. Richard Feynman describes polar vectors as 'honest' vectors [7] and represent the every-day vectors of directed lines. Whereas, axial vectors are computed from polar vectors, such as in a vector product. However, these two types of vector do not behave in the same way when transformed. For example, given two 'honest', polar vectors $\mathbf{a}$ and $\mathbf{b}$, we can compute the axial vector: $\mathbf{c}=\mathbf{a} \times \mathbf{b}$. Next, if we subject $\mathbf{a}$ and $\mathbf{b}$ to an inversion transform through the origin, such that $\mathbf{a}$ becomes $-\mathbf{a}$, and $\mathbf{b}$ becomes $-\mathbf{b}$, and compute their cross product $(-\mathbf{a}) \times(-\mathbf{b})$, we still get c! Which implies that the axial vector $\mathbf{c}$ must not be transformed along with a and $\mathbf{b}$.

It could be argued that the inversion transform is not a 'proper' transform as it turns a right-handed set of axes into a left-handed set. But in physics, laws of nature are expected to work in either system. Unfortunately, Hamilton was not aware of this distinction, as he had only just invented vectors. However, in the intervening years, it has become evident that Hamilton's quaternion vector is an axial vector, and not a polar vector. As we will see, in 3-D rotations quaternions take the form

$$
    q=\left[\cos \left(\frac{\theta}{2}\right), \sin \left(\frac{\theta}{2}\right) \mathbf{v}\right]
$$

where $\theta$ is the angle of rotation and $\mathbf{v}$ is the axis of rotation, and when we set $\theta=180^{\circ}$, we get

$$
    q=[0, \mathbf{v}]
$$

which remains a quaternion, even though it only contains a vector part.

Consequently, we define a pure quaternion as

$$
    q=[0, \mathbf{v}]
$$

The product of two pure quaternions is

$$
    \begin{aligned}
        q_{a}       & =[0, \mathbf{a}]                                              \\
        q_{b}       & =[0, \mathbf{b}]                                              \\
        q_{a} q_{b} & =[0, \mathbf{a}][0, \mathbf{b}]                               \\
                    & =[-\mathbf{a} \cdot \mathbf{b}, \mathbf{a} \times \mathbf{b}]
    \end{aligned}
$$

which is no longer 'pure', as some of the original vector information has 'tunnelled' across into the real part via the dot product.

\section{单位四元数}
Let's pursue this analysis further by introducing some familiar vector notation.

Give vector $\mathbf{v}$, then

$$
    \mathbf{v}=\lambda \hat{\mathbf{v}}, \quad \text { where } \lambda=\|\mathbf{v}\| \text { and }\|\hat{\mathbf{v}}\|=1
$$

Combining this with the definition of a pure quaternion we get:

$$
    \begin{aligned}
        q & =[0, \mathbf{v}]               \\
          & =[0, \lambda \hat{\mathbf{v}}] \\
          & =\lambda[0, \hat{\mathbf{v}}]
    \end{aligned}
$$

and reveals the object $[0, \hat{\mathbf{v}}]$ which is called the unit quaternion and comprises a zero scalar and a unit vector. It is convenient to identify this unit quaternion as $\hat{q}$ :

$$
    \hat{q}=[0, \hat{\mathbf{v}}]
$$

So now we have a notation similar to that of vectors where a vector $\mathbf{v}$ is described in terms of its unit form:

$$
    \mathbf{v}=\lambda \hat{\mathbf{v}}
$$

and a quaternion $q$ is also described in terms of its unit form:

$$
    q=\lambda \hat{q}
$$

Note that $\hat{q}$ is an imaginary object as it squares to -1 :

$$
    \begin{aligned}
        \hat{q}^{2} & =[0, \hat{\mathbf{v}}][0, \hat{\mathbf{v}}]                                           \\
                    & =[-\hat{\mathbf{v}} \cdot \hat{\mathbf{v}}, \hat{\mathbf{v}} \times \hat{\mathbf{v}}] \\
                    & =[-1, \mathbf{0}]                                                                     \\
                    & =-1
    \end{aligned}
$$

which is not too surprising, bearing in mind Hamilton's original invention!

\section{四元数的加法形式}
We now come to the idea of splitting a quaternion into its constituent parts: a real quaternion and a pure quaternion. Again, intuition suggests that we can write a quaternion as

$$
    \begin{aligned}
        q & =[s, \mathbf{v}]                 \\
          & =[s, \mathbf{0}]+[0, \mathbf{v}]
    \end{aligned}
$$

and we can test this by forming the algebraic product of two quaternions represented in this way:

$$
    \begin{aligned}
        q_{a}       & =\left[s_{a}, \mathbf{0}\right]+[0, \mathbf{a}]                                                                                                                                          \\
        q_{b}       & =\left[s_{b}, \mathbf{0}\right]+[0, \mathbf{b}]                                                                                                                                          \\
        q_{a} q_{b} & =\left(\left[s_{a}, \mathbf{0}\right]+[0, \mathbf{a}]\right)\left(\left[s_{b}, \mathbf{0}\right]+[0, \mathbf{b}]\right)                                                                  \\
                    & =\left[s_{a}, \mathbf{0}\right]\left[s_{b}, \mathbf{0}\right]+\left[s_{a}, \mathbf{0}\right][0, \mathbf{b}]+[0, \mathbf{a}]\left[s_{b}, \mathbf{0}\right]+[0, \mathbf{a}][0, \mathbf{b}] \\
                    & =\left[s_{a} s_{b}, \mathbf{0}\right]+\left[0, s_{a} \mathbf{b}\right]+\left[0, s_{b} \mathbf{a}\right]+[-\mathbf{a} \cdot \mathbf{b}, \mathbf{a} \times \mathbf{b}]                     \\
                    & =\left[s_{a} s_{b}-\mathbf{a} \cdot \mathbf{b}, s_{a} \mathbf{b}+s_{b} \mathbf{a}+\mathbf{a} \times \mathbf{b}\right]
    \end{aligned}
$$

which is correct, and confirms that the additive form works.

\section{四元数的双体形式}
Having shown that the additive form of a quaternion works, and discovered the unit quaternion, we can join the two objects together as follows:

$$
    \begin{aligned}
        q & =[s, \mathbf{v}]                              \\
          & =[s, \mathbf{0}]+[0, \mathbf{v}]              \\
          & =[s, \mathbf{0}]+\lambda[0, \hat{\mathbf{v}}] \\
          & =s+\lambda \hat{q} .
    \end{aligned}
$$

Just to recap, $s$ is a scalar, $\lambda$ is the length of the vector term, and $\hat{q}$ is the unit quaternion $[0, \hat{\mathbf{v}}]$.

Look how similar this notation is to a complex number:

$$
    \begin{aligned}
         & z=a+b i             \\
         & q=s+\lambda \hat{q}
    \end{aligned}
$$

where $a, b, s, \lambda$ are scalars, $i$ is the unit imaginary and $\hat{q}$ is the unit quaternion.

\section{四元数的复共轭}
We have already discovered that the conjugate of a complex number $z=a+b \mathrm{i}$ is given by

$$
    z^{*}=a-b \mathrm{i}
$$

and is very useful in computing the inverse of $z$. The quaternion conjugate plays a similar role in computing the inverse of a quaternion. Therefore, given

$$
    q=[s, \mathbf{v}]
$$

the quaternion conjugate is defined as

$$
    q^{*}=[s,-\mathbf{v}]
$$

For example:

$$
    \begin{aligned}
        q     & =[2,3 \mathbf{i}-4 \mathbf{j}+5 \mathbf{k}]  \\
        q^{*} & =[2,-3 \mathbf{i}+4 \mathbf{j}-5 \mathbf{k}]
    \end{aligned}
$$

If we compute the product $q q^{*}$ we obtain

$$
    \begin{aligned}
        q q^{*} & =[s, \mathbf{v}][s,-\mathbf{v}]                                                                             \\
                & =\left[s^{2}-\mathbf{v} \cdot(-\mathbf{v}),-s \mathbf{v}+s \mathbf{v}+\mathbf{v} \times(-\mathbf{v})\right] \\
                & =\left[s^{2}+\mathbf{v} \cdot \mathbf{v}, \mathbf{0}\right]                                                 \\
                & =\left[s^{2}+v^{2}, \mathbf{0}\right] .
    \end{aligned}
$$

Let's show that $q q^{*}=q^{*} q$ :

$$
    \begin{aligned}
        q^{*} q & =[s,-\mathbf{v}][s, \mathbf{v}]                                                                               \\
                & =\left[s^{2}-(-\mathbf{v}) \cdot \mathbf{v}, s \mathbf{v}-s \mathbf{v}+(-\mathbf{v}) \times \mathbf{v}\right] \\
                & =\left[s^{2}+\mathbf{v} \cdot \mathbf{v}, \mathbf{0}\right]                                                   \\
                & =\left[s^{2}+v^{2}, \mathbf{0}\right]                                                                         \\
                & =q q^{*}
    \end{aligned}
$$

Now let's show that $\left(q_{a} q_{b}\right)^{*}=q_{b}^{*} q_{a}^{*}$.

$$
    \begin{aligned}
        q_{a}                        & =\left[s_{a}, \mathbf{a}\right]                                                                                         \\
        q_{b}                        & =\left[s_{b}, \mathbf{b}\right]                                                                                         \\
        q_{a} q_{b}                  & =\left[s_{a}, \mathbf{a}\right]\left[s_{b}, \mathbf{b}\right]                                                           \\
                                     & =\left[s_{a} s_{b}-\mathbf{a} \cdot \mathbf{b}, s_{a} \mathbf{b}+s_{b} \mathbf{a}+\mathbf{a} \times \mathbf{b}\right]   \\
        \left(q_{a} q_{b}\right)^{*} & =\left[s_{a} s_{b}-\mathbf{a} \cdot \mathbf{b},-s_{a} \mathbf{b}-s_{b} \mathbf{a}-\mathbf{a} \times \mathbf{b}\right] .
    \end{aligned}
$$

Next, we compute $q_{b}^{*} q_{a}^{*}$

$$
    \begin{aligned}
        q_{a}^{*}           & =\left[s_{a},-\mathbf{a}\right]                                                                                         \\
        q_{b}^{*}           & =\left[s_{b},-\mathbf{b}\right]                                                                                         \\
        q_{b}^{*} q_{a}^{*} & =\left[s_{b},-\mathbf{b}\right]\left[s_{a},-\mathbf{a}\right]                                                           \\
                            & =\left[s_{a} s_{b}-\mathbf{a} \cdot \mathbf{b},-s_{a} \mathbf{b}-s_{b} \mathbf{a}-\mathbf{a} \times \mathbf{b}\right] .
    \end{aligned}
$$

And as (6.10) equals $(6.11),\left(q_{a} q_{b}\right)^{*}=q_{b}^{*} q_{a}^{*}$.

\section{四元数的范数}
The norm of a complex number $z=a+b i$ is defined as:

$$
    |z|=\sqrt{a^{2}+b^{2}}
$$

which allows us to write

$$
    z z^{*}=|z|^{2}
$$

Similarly, the norm of a quaternion $q$ is defined as:

$$
    \begin{aligned}
        q   & =[s, \mathbf{v}]               \\
            & =[s, \lambda \hat{\mathbf{v}}] \\
        |q| & =\sqrt{s^{2}+\lambda^{2}}
    \end{aligned}
$$

where $\lambda=\|\mathbf{v}\|$ which allows us to write

$$
    q q^{*}=|q|^{2}
$$

For example:

$$
    \begin{aligned}
        q   & =[1,4 \mathbf{i}+4 \mathbf{j}-4 \mathbf{k}] \\
        |q| & =\sqrt{1^{2}+4^{2}+4^{2}+(-4)^{2}}          \\
            & =\sqrt{49}                                  \\
            & =7
    \end{aligned}
$$

\section{归一化四元数}
A quaternion with a unit norm is called a normalised quaternion. For example, the quaternion $q=[s, \mathbf{v}]$ is normalised by dividing it by $|q|$ :

$$
    q^{\prime}=\frac{q}{\sqrt{s^{2}+\lambda^{2}}}
$$

We must be careful not to confuse the unit quaternion with a unit-norm quaternion. The unit quaternion is $[0, \hat{\mathbf{v}}]$ with a unit-vector part, whereas a unit-norm quaternion is normalised such that $s^{2}+\lambda^{2}=1$.

I will be careful to distinguish between these two terms as many authorsincluding myself-use the term unit quaternion to describe a quaternion with a unit norm. For example:

$$
    q=[1,4 \mathbf{i}+4 \mathbf{j}-4 \mathbf{k}]
$$

has a norm of 7 , and $q$ is normalised by dividing by 7 :

$$
    q^{\prime}=\frac{1}{7}[1,4 \mathbf{i}+4 \mathbf{j}-4 \mathbf{k}]
$$

The type of unit-norm quaternion we will be using takes the form:

$$
    q=\left[\cos \left(\frac{\theta}{2}\right), \sin \left(\frac{\theta}{2}\right) \hat{\mathbf{v}}\right]
$$

because $\cos ^{2} \theta+\sin ^{2} \theta=1$

\section{四元数乘积}
Having shown that ordered pairs can represent a quaternion and its various manifestations, let's summarise the products we will eventually encounter. To start, we have the product of two normal quaternions:

$$
    \begin{aligned}
        q_{a} q_{b} & =\left[s_{a}, \mathbf{a}\right]\left[s_{b}, \mathbf{b}\right]                                                           \\
                    & =\left[s_{a} s_{b}-\mathbf{a} \cdot \mathbf{b}, s_{a} \mathbf{b}+s_{b} \mathbf{a}+\mathbf{a} \times \mathbf{b}\right] .
    \end{aligned}
$$

\subsection{纯四元数的乘积}
Given two pure quaternions:

$$
    \begin{aligned}
         & q_{a}=[0, \mathbf{a}] \\
         & q_{b}=[0, \mathbf{b}]
    \end{aligned}
$$

their product is

$$
    \begin{aligned}
        q_{a} q_{b} & =[0, \mathbf{a}][0, \mathbf{b}]                                 \\
                    & =[-\mathbf{a} \cdot \mathbf{b}, \mathbf{a} \times \mathbf{b}] .
    \end{aligned}
$$

\subsection{两个归一化四元数的乘积}
Given two unit-norm quaternions:

$$
    \begin{aligned}
         & q_{a}=\left[s_{a}, \mathbf{a}\right] \\
         & q_{b}=\left[s_{b}, \mathbf{b}\right]
    \end{aligned}
$$

where $\left|q_{a}\right|=\left|q_{b}\right|=1$. Their product is another unit-norm quaternion, which is proved as follows.

We assume $q_{c}=\left[s_{c}, \mathbf{c}\right]$ and show that $\left|q_{c}\right|=s_{c}^{2}+c^{2}=1$ where

$$
    \begin{aligned}
        {\left[s_{c}, \mathbf{c}\right] } & =\left[s_{a}, \mathbf{a}\right]\left[s_{b}, \mathbf{b}\right]                                                           \\
                                          & =\left[s_{a} s_{b}-\mathbf{a} \cdot \mathbf{b}, s_{a} \mathbf{b}+s_{b} \mathbf{a}+\mathbf{a} \times \mathbf{b}\right] .
    \end{aligned}
$$

Let's assume the angle between $\mathbf{a}$ and $\mathbf{b}$ is $\theta$, which permits us to write:

$$
    \begin{aligned}
         & s_{c}=s_{a} s_{b}-a b \cos \theta                                                                                        \\
         & \mathbf{c}=s_{a} b \hat{\mathbf{b}}+s_{b} a \hat{\mathbf{a}}+a b \sin \theta(\hat{\mathbf{a}} \times \hat{\mathbf{b}}) .
    \end{aligned}
$$

Fig. 6.2 Geometry for $s_{a} b \hat{\mathbf{b}}+s_{b} a \hat{\mathbf{a}}+a b \sin \theta(\hat{\mathbf{a}} \times$ b)

    \begin{center}
        \includegraphics[max width=\textwidth]{2023_04_20_41f1ceac5a31dc7d1b59g-104}
    \end{center}

    Therefore,

    $$
        \begin{aligned}
            s_{c}^{2} & =\left(s_{a} s_{b}-a b \cos \theta\right)\left(s_{a} s_{b}-a b \cos \theta\right) \\
                      & =s_{a}^{2} s_{b}^{2}-2 s_{a} s_{b} a b \cos \theta+a^{2} b^{2} \cos ^{2} \theta .
        \end{aligned}
    $$

    Figure 6.2 shows the geometry representing $\mathbf{c}$.

    $$
        \begin{aligned}
            d^{2}           & =s_{b}^{2} a^{2}+s_{a}^{2} b^{2}-2 s_{a} s_{b} a b \cos (\pi-\theta)                                                                                                       \\
                            & =s_{b}^{2} a^{2}+s_{a}^{2} b^{2}+2 s_{a} s_{b} a b \cos \theta                                                                                                             \\
            c^{2}           & =d^{2}+a^{2} b^{2} \sin ^{2} \theta                                                                                                                                        \\
                            & =s_{b}^{2} a^{2}+s_{a}^{2} b^{2}+2 s_{a} s_{b} a b \cos \theta+a^{2} b^{2} \sin ^{2} \theta                                                                                \\
            s_{c}^{2}+c^{2} & =s_{a}^{2} s_{b}^{2}-2 s_{a} s_{b} a b \cos \theta+a^{2} b^{2} \cos ^{2} \theta+s_{b}^{2} a^{2}+s_{a}^{2} b^{2}+2 s_{a} s_{b} a b \cos \theta+a^{2} b^{2} \sin ^{2} \theta \\
                            & =s_{a}^{2} s_{b}^{2}+a^{2} b^{2}+s_{b}^{2} a^{2}+s_{a}^{2} b^{2}                                                                                                           \\
                            & =s_{a}^{2}\left(s_{b}^{2}+b^{2}\right)+a^{2}\left(s_{b}^{2}+b^{2}\right)                                                                                                   \\
                            & =s_{a}^{2}+a^{2}                                                                                                                                                           \\
                            & =1
        \end{aligned}
    $$

    Therefore, the product of two unit-norm quaternions is another unit-norm quaternion. Consequently, multiplying a quaternion by a unit-norm quaternion, does not change its norm:

    $$
        \begin{aligned}
            q_{a}                    & =\left[s_{a}, \mathbf{a}\right] \\
            \left|q_{a}\right|       & =1                              \\
            q_{b}                    & =\left[s_{b}, \mathbf{b}\right] \\
            \left|q_{a} q_{b}\right| & =\left|q_{b}\right| .
        \end{aligned}
    $$

    \subsection{四元数的平方}
    The square of a quaternion is given by:

    $$
        \begin{aligned}
            \mathbf{v} & =x \mathbf{i}+y \mathbf{j}+z \mathbf{k}                                                      \\
            q          & =[s, \mathbf{v}]                                                                             \\
            q^{2}      & =[s, \mathbf{v}][s, \mathbf{v}]                                                              \\
                       & =\left[s^{2}-\mathbf{v} \cdot \mathbf{v}, 2 s \mathbf{v}+\mathbf{v} \times \mathbf{v}\right] \\
                       & =\left[s^{2}-\mathbf{v} \cdot \mathbf{v}, 2 s \mathbf{v}\right]                              \\
                       & =\left[s^{2}-x^{2}-y^{2}-z^{2}, 2 s(x \mathbf{i}+y \mathbf{j}+z \mathbf{k})\right] .
        \end{aligned}
    $$

    For example:

    $$
        \begin{aligned}
            q     & =[7,2 \mathbf{i}+3 \mathbf{j}+4 \mathbf{k}]                                             \\
            q^{2} & =\left[7^{2}-2^{2}-3^{2}-4^{2}, \quad 14(2 \mathbf{i}+3 \mathbf{j}+4 \mathbf{k})\right] \\
                  & =[20,28 \mathbf{i}+42 \mathbf{j}+56 \mathbf{k}]
        \end{aligned}
    $$

    The square of a pure quaternion is

    $$
        \begin{aligned}
            \mathbf{v} & =x \mathbf{i}+y \mathbf{j}+z \mathbf{k}                        \\
            q          & =[0, \mathbf{v}]                                               \\
            q^{2}      & =[0, \mathbf{v}][0, \mathbf{v}]                                \\
                       & =[0-\mathbf{v} \cdot \mathbf{v}, \mathbf{v} \times \mathbf{v}] \\
                       & =[0-\mathbf{v} \cdot \mathbf{v}, \mathbf{0}]                   \\
                       & =\left[-\left(x^{2}+y^{2}+z^{2}\right), \mathbf{0}\right]
        \end{aligned}
    $$

    which makes the square of a pure, unit-norm quaternion equal to -1 , and was one of the results, to which some 19th-century mathematicians objected.

    \subsection{四元数乘积的范数}
    In proving that the product of two unit-norm quaternions is another unit-norm quaternion we saw that
    $$
        \begin{aligned}
            q_{a}                  & =\left[s_{a}, \mathbf{a}\right]                                          \\
            q_{b}                  & =\left[s_{b}, \mathbf{b}\right]                                          \\
            q_{c}                  & =q_{a} q_{b}                                                             \\
            \left|q_{c}\right|^{2} & =s_{a}^{2}\left(s_{b}^{2}+b^{2}\right)+a^{2}\left(s_{b}^{2}+b^{2}\right) \\
                                   & =\left(s_{a}^{2}+a^{2}\right)\left(s_{b}^{2}+b^{2}\right)
        \end{aligned}
    $$

    which, if we ignore the constraint of unit-norm quaternions, shows that the norm of a quaternion product equals the product of the individual norms:

    $$
        \begin{aligned}
            \left|q_{a} q_{b}\right|^{2} & =\left|q_{a}\right|^{2}\left|q_{b}\right|^{2} \\
            \left|q_{a} q_{b}\right|     & =\left|q_{a}\right|\left|q_{b}\right|
        \end{aligned}
    $$

    \section{逆四元数}
    An important feature of quaternion algebra is the ability to divide two quaternions $q_{b} / q_{a}$, as long as $q_{a}$ does not vanish.

    By definition, the inverse $q^{-1}$ of $q$ satisfies

    $$
        q q^{-1}=[1,0]=1
    $$

    To isolate $q^{-1}$, we multiply (6.12) by $q^{*}$

    $$
        \begin{aligned}
             & q^{*} q q^{-1}=q^{*} \\
             & |q|^{2} q^{-1}=q^{*}
        \end{aligned}
    $$

    and from (6.13) we can write

    $$
        q^{-1}=\frac{q^{*}}{|q|^{2}}
    $$

    If $q$ is a unit-norm quaternion, then

    $$
        q^{-1}=q^{*}
    $$

    which is useful in the context of rotations.

    Furthermore, as

    $$
        \left(q_{a} q_{b}\right)^{*}=q_{b}^{*} q_{a}^{*}
    $$

    then

    $$
        \left(q_{a} q_{b}\right)^{-1}=q_{b}^{-1} q_{a}^{-1}
    $$

    Note that $q q^{-1}=q^{-1} q$ :

    $$
        \begin{aligned}
             & q q^{-1}=\frac{q q^{*}}{|q|^{2}}=1 \\
             & q^{-1} q=\frac{q^{*} q}{|q|^{2}}=1
        \end{aligned}
    $$

    Thus, we represent the quotient $q_{b} / q_{a}$ as

    $$
        \begin{aligned}
            q_{c} & =\frac{q_{b}}{q_{a}}                            \\
                  & =q_{b} q_{a}^{-1}                               \\
                  & =\frac{q_{b} q_{a}^{*}}{\left|q_{a}\right|^{2}}
        \end{aligned}
    $$

    For completeness let's evaluate the inverse of $q$ where

    $$
        \begin{aligned}
            q                            & =\left[1, \frac{1}{\sqrt{3}} \mathbf{i}+\frac{1}{\sqrt{3}} \mathbf{j}+\frac{1}{\sqrt{3}} \mathbf{k}\right]              \\
            q^{*}                        & =\left[1,-\frac{1}{\sqrt{3}} \mathbf{i}-\frac{1}{\sqrt{3}} \mathbf{j}-\frac{1}{\sqrt{3}} \mathbf{k}\right]              \\
            |q|^{2}                      & =1+\frac{1}{3}+\frac{1}{3}+\frac{1}{3}=2                                                                                \\
            q^{-1}=\frac{q^{*}}{|q|^{2}} & =\frac{1}{2}\left[1,-\frac{1}{\sqrt{3}} \mathbf{i}-\frac{1}{\sqrt{3}} \mathbf{j}-\frac{1}{\sqrt{3}} \mathbf{k}\right] .
        \end{aligned}
    $$

    It should be clear that $q^{-1} q=1$ :

    $$
        \begin{aligned}
            q^{-1} q & =\frac{1}{2}\left[1,-\frac{1}{\sqrt{3}} \mathbf{i}-\frac{1}{\sqrt{3}} \mathbf{j}-\frac{1}{\sqrt{3}} \mathbf{k}\right]\left[1, \frac{1}{\sqrt{3}} \mathbf{i}+\frac{1}{\sqrt{3}} \mathbf{j}+\frac{1}{\sqrt{3}} \mathbf{k}\right] \\
                     & =\frac{1}{2}\left[1+\frac{1}{3}+\frac{1}{3}+\frac{1}{3}, \mathbf{0}\right]                                                                                                                                                     \\
                     & =1
        \end{aligned}
    $$

    \section{矩阵}
    Matrices provide another way to express a quaternion product. For convenience, let's repeat (6.8) again and show it in matrix form:

    $$
        \begin{aligned}
            {\left[s_{a}, \mathbf{a}\right]\left[s_{b}, \mathbf{b}\right]=} & {\left[s_{a} s_{b}-x_{a} x_{b}-y_{a} y_{b}-z_{a} z_{b}\right.}                                                                                                \\
                                                                            & +s_{a}\left(x_{b} \mathbf{i}+y_{b} \mathbf{j}+z_{b} \mathbf{k}\right)+s_{b}\left(x_{a} \mathbf{i}+y_{a} \mathbf{j}+z_{a} \mathbf{k}\right)                    \\
                                                                            & \left.+\left(y_{a} z_{b}-y_{b} z_{a}\right) \mathbf{i}+\left(z_{a} x_{b}-z_{b} x_{a}\right) \mathbf{j}+\left(x_{a} y_{b}-x_{b} y_{a}\right) \mathbf{k}\right] \\
                                                                            & {\left[\begin{array}{rrr}
                            s_{a}-x_{a}-y_{a}-z_{a}                 \\
                            x_{a}       & s_{a}-z_{a} & y_{a}       \\
                            y_{a}       & z_{a}       & s_{a}-x_{a} \\
                            z_{a}-y_{a} & x_{a}       & s_{a}
                        \end{array}\right]\left[\begin{array}{c}
                            s_{b} \\
                            x_{b} \\
                            y_{b} \\
                            z_{b}
                        \end{array}\right] }
        \end{aligned}
    $$

    Let's recompute the product $q_{a} q_{b}$ using the above matrix:

    $$
        \begin{aligned}
             & q_{a}=[1,2 \mathbf{i}+3 \mathbf{j}+4 \mathbf{k}]                                           \\
             & q_{b}=[2,3 \mathbf{i}+4 \mathbf{j}+5 \mathbf{k}]                                           \\
             & q_{a} q_{b}=\left[\begin{array}{rrrr}
                    1 & -2 & -3 & -4 \\
                    2 & 1  & -4 & 3  \\
                    3 & 4  & 1  & -2 \\
                    4 & -3 & 2  & 1
                \end{array}\right]\left[\begin{array}{l}
                    2 \\
                    3 \\
                    4 \\
                    5
                \end{array}\right] \\
             & =\left[\begin{array}{r}
                    -36 \\
                    6   \\
                    12  \\
                    12
                \end{array}\right]                                                   \\
             & =[-36,6 \mathbf{i}+12 \mathbf{j}+12 \mathbf{k}] \text {. }
        \end{aligned}
    $$

    \subsection{正交矩阵}
    We can demonstrate that the unit-norm quaternion matrix is orthogonal by showing that the product with its transpose equals the identity matrix. As we are dealing with matrices, $\mathbf{Q}$ will represent the matrix for $q$ :

    $$
        \begin{aligned}
             & q=[s, x \mathbf{i}+y \mathbf{j}+z \mathbf{k}]                                                                     \\
             & \text { where } 1=s^{2}+x^{2}+y^{2}+z^{2}                                                                         \\
             & \mathbf{Q}=\left[\begin{array}{rrrr}
                    s & -x & -y & -z \\
                    x & s  & -z & y  \\
                    y & z  & s  & -x \\
                    z & -y & x  & s
                \end{array}\right]                                                                \\
             & \mathbf{Q}^{\mathrm{T}}=\left[\begin{array}{rrrr}
                    s  & x  & y  & z  \\
                    -x & s  & z  & -y \\
                    -y & -z & s  & x  \\
                    -z & y  & -x & s
                \end{array}\right]                                                   \\
             & \mathbf{Q} \mathbf{Q}^{\mathrm{T}}=\left[\begin{array}{rrrr}
                    s & -x & -y & -z \\
                    x & s  & -z & y  \\
                    y & z  & s  & -x \\
                    z & -y & x  & s
                \end{array}\right]\left[\begin{array}{rrrr}
                    s  & x  & y  & z  \\
                    -x & s  & z  & -y \\
                    -y & -z & s  & x  \\
                    -z & y  & -x & s
                \end{array}\right] \\
             & =\left[\begin{array}{llll}
                    1 & 0 & 0 & 0 \\
                    0 & 1 & 0 & 0 \\
                    0 & 0 & 1 & 0 \\
                    0 & 0 & 0 & 1
                \end{array}\right]
        \end{aligned}
    $$

    For this to occur, $\mathbf{Q}^{\mathrm{T}}=\mathbf{Q}^{-1}$.

    \section{四元数代数}
    Ordered pairs provide a simple notation for representing quaternions, and allow us to represent the real unit 1 as $[1, \mathbf{0}]$, and the imaginaries $i, j, k$ as $[0, \mathbf{i}],[0, \mathbf{j}],[0, \mathbf{k}]$ respectively. A quaternion then becomes a linear combination of these elements with associated real coefficients. Under such conditions, the elements form the basis for an algebra over the field of reals.

    Furthermore, because quaternion algebra supports division, and obeys the normal axioms of algebra, except that multiplication is non-commutative, it is called a division algebra. The German mathematician Ferdinand Georg Frobenius proved that only three such real associative division algebras exist: real numbers, complex numbers and quaternions [8].

    The Cayley numbers $\mathbb{O}$, constitute a real division algebra, but the Cayley numbers are 8-dimensional and are not associative, i.e. $a(b c) \neq(a b) c$ for all $a, b, c \in \mathbb{O}$.

\section{总结}
四元数与复数非常相似，除了它们有三个虚数项，而不是一个。因此，它们继承了一些与复数有关的性质，如范数、复共轭、单位范数和逆。它们也可以被加、减、乘、除。然而，与复数不同的是，它们在相乘时是反交换的。

\subsection{定义总结}
\begin{tcolorbox}[breakable, enhanced,title = {四元数}]
    $$
        \begin{aligned}
             & q_{a}=\left[s_{a}, \mathbf{a}\right]=\left[s_{a}, x_{a} \mathbf{i}+y_{a} \mathbf{j}+z_{a} \mathbf{k}\right]   \\
             & q_{b}=\left[s_{b}, \mathbf{b}\right]=\left[s_{b}, x_{b} \mathbf{i}+y_{b} \mathbf{j}+z_{b} \mathbf{k}\right] .
        \end{aligned}
    $$
\end{tcolorbox}


\begin{tcolorbox}[breakable, enhanced,title = {加减法}]
    $$
        q_{a} \pm q_{b}=\left[s_{a} \pm s_{b}, \mathbf{a} \pm \mathbf{b}\right] .
    $$
\end{tcolorbox}

\begin{tcolorbox}[breakable, enhanced,title = {乘积}]
    $$
        \begin{aligned}
            q_{a} q_{b} & =\left[s_{a}, \mathbf{a}\right]\left[s_{b}, \mathbf{b}\right]                                                         \\
                        & =\left[s_{a} s_{b}-\mathbf{a} \cdot \mathbf{b}, s_{a} \mathbf{b}+s_{b} \mathbf{a}+\mathbf{a} \times \mathbf{b}\right] \\
                        & =\left[\begin{array}{rrr}
                    s_{a}-x_{a}-y_{a}-z_{a}                 \\
                    x_{a}       & s_{a}-z_{a} & y_{a}       \\
                    y_{a}       & z_{a}       & s_{a}-x_{a} \\
                    z_{a}-y_{a} & x_{a}       & s_{a}
                \end{array}\right]\left[\begin{array}{c}
                    s_{b} \\
                    x_{b} \\
                    y_{b} \\
                    z_{b}
                \end{array}\right] .
        \end{aligned}
    $$
\end{tcolorbox}

\begin{tcolorbox}[breakable, enhanced,title = {平方}]
    $$
        \begin{aligned}
            \mathbf{v} & =x \mathbf{i}+y \mathbf{j}+z \mathbf{k}                                            \\
            q^{2}      & =[s, \mathbf{v}][s, \mathbf{v}]                                                    \\
                       & =\left[s^{2}-x^{2}-y^{2}-z^{2}, 2 s(x \mathbf{i}+y \mathbf{j}+z \mathbf{k})\right]
        \end{aligned}
    $$
\end{tcolorbox}

\begin{tcolorbox}[breakable, enhanced,title = {纯四元数}]
    $$
        \begin{aligned}
            \mathbf{v} & =x \mathbf{i}+y \mathbf{j}+z \mathbf{k}                   \\
            q^{2}      & =[0, \mathbf{v}][0, \mathbf{v}]                           \\
                       & =\left[-\left(x^{2}+y^{2}+z^{2}\right), \mathbf{0}\right]
        \end{aligned}
    $$
\end{tcolorbox}

\begin{tcolorbox}[breakable, enhanced,title = {范数}]
    $$
        \begin{aligned}
            \mathbf{v} & =\lambda \hat{\mathbf{v}}      \\
            q          & =[s, \lambda \hat{\mathbf{v}}] \\
            |q|        & =\sqrt{s^{2}+\lambda^{2}}
        \end{aligned}
    $$
\end{tcolorbox}

\begin{tcolorbox}[breakable, enhanced,title = {单位范数}]
    $$
        |q|=\sqrt{s^{2}+\lambda^{2}}=1 .
    $$
\end{tcolorbox}

\begin{tcolorbox}[breakable, enhanced,title = {共轭}]
    $$
        \begin{aligned}
            q^{*}                        & =[s,-\mathbf{v}]       \\
            \left(q_{a} q_{b}\right)^{*} & =q_{b}^{*} q_{a}^{*} .
        \end{aligned}
    $$
\end{tcolorbox}

\begin{tcolorbox}[breakable, enhanced,title = {逆}]
    $$
        \begin{aligned}
            q^{-1}                        & =\frac{q^{*}}{|q|^{2}} \\
            \left(q_{a} q_{b}\right)^{-1} & =q_{b}^{-1} q_{a}^{-1}
        \end{aligned}
    $$
\end{tcolorbox}

\section{样例}
下面是一些运用了上述想法的进一步实例。在某些情况下，还包括一个测试来确认结果。

\begin{myexample}{四元数的加法和减法}{theoexample}
对下列四元数进行加减运算：
$$
    \begin{aligned}
        q_{a}       & =[2,-2 \mathbf{i}+3 \mathbf{j}-4 \mathbf{k}]  \\
        q_{b}       & =[1,-2 \mathbf{i}+5 \mathbf{j}-6 \mathbf{k}]  \\
        q_{a}+q_{b} & =[3,-4 \mathbf{i}+8 \mathbf{j}-10 \mathbf{k}] \\
        q_{a}-q_{b} & =[1,0 \mathbf{i}-2 \mathbf{j}+2 \mathbf{k}] .
    \end{aligned}
$$
\end{myexample}

\begin{myexample}{四元数范数}{theoexample}
求下列四元数的范数：
$$
    \begin{aligned}
        q_{a}              & =[2,-2 \mathbf{i}+3 \mathbf{j}-4 \mathbf{k}]      \\
        q_{b}              & =[1,-2 \mathbf{i}+5 \mathbf{j}-6 \mathbf{k}]      \\
        \left|q_{a}\right| & =\sqrt{2^{2}+(-2)^{2}+3^{2}+(-4)^{2}}=\sqrt{33}   \\
        \left|q_{b}\right| & =\sqrt{1^{2}+(-2)^{2}+5^{2}+(-6)^{2}}=\sqrt{66} .
    \end{aligned}
$$
\end{myexample}

\begin{myexample}{单位范数四元数}{theoexample}
将这些四元数转换为单位范数形式：
$$
    \begin{aligned}
        q_{a}              & =[2,-2 \mathbf{i}+3 \mathbf{j}-4 \mathbf{k}]                    \\
        q_{b}              & =[1,-2 \mathbf{i}+5 \mathbf{j}-6 \mathbf{k}]                    \\
        \left|q_{a}\right| & =\sqrt{33}                                                      \\
        \left|q_{b}\right| & =\sqrt{66}                                                      \\
        q_{a}^{\prime}     & =\frac{1}{\sqrt{33}}[2,-2 \mathbf{i}+3 \mathbf{j}-4 \mathbf{k}] \\
        q_{b}^{\prime}     & =\frac{1}{\sqrt{66}}[1,-2 \mathbf{i}+5 \mathbf{j}-6 \mathbf{k}]
    \end{aligned}
$$
\end{myexample}

\begin{myexample}{四元数乘积}{theoexample}
计算下列四元数的乘积和反向乘积。
$$
    \begin{aligned}
        q_{a}       & =[2,-2 \mathbf{i}+3 \mathbf{j}-4 \mathbf{k}]                                            \\
        q_{b}       & =[1,-2 \mathbf{i}+5 \mathbf{j}-6 \mathbf{k}]                                            \\
        q_{a} q_{b} & =[2,-2 \mathbf{i}+3 \mathbf{j}-4 \mathbf{k}][1,-2 \mathbf{i}+5 \mathbf{j}-6 \mathbf{k}] \\
                    & =[2 \times 1-((-2) \times(-2)+3 \times 5+(-4) \times(-6)),                              \\
                    & +2(-2 \mathbf{i}+5 \mathbf{j}-6 \mathbf{k})+1(-2 \mathbf{i}+3 \mathbf{j}-4 \mathbf{k})  \\
                    & +(3 \times(-6)-(-4) \times 5) \mathbf{i}-((-2) \times(-6)-(-4) \times(-2)) \mathbf{j}   \\
                    & +((-2) \times 5-3 \times(-2)) \mathbf{k}]                                               \\
                    & =[-41,-6 \mathbf{i}+13 \mathbf{j}-16 \mathbf{k}+2 \mathbf{i}-4 \mathbf{j}-4 \mathbf{k}] \\
                    & =[-41,-4 \mathbf{i}+9 \mathbf{j}-20 \mathbf{k}] .                                       \\
        q_{b} q_{a} & =[1,-2 \mathbf{i}+5 \mathbf{j}-6 \mathbf{k}][2-2 \mathbf{i}+3 \mathbf{j}-4 \mathbf{k}]  \\
                    & =[1 \times 2-((-2) \times(-2)+5 \times 3+(-6) \times(-4)),                              \\
                    & +1(-2 \mathbf{i}+3 \mathbf{j}-4 \mathbf{k})+2(-2 \mathbf{i}+5 \mathbf{j}-6 \mathbf{k})  \\
                    & +(5 \times(-4)-(-6) \times 3) \mathbf{i}-((-2) \times(-4)-(-6) \times(-2)) \mathbf{j}   \\
                    & +((-2) \times 3-5 \times(-2)) \mathbf{k}]                                               \\
                    & =[-41,-6 \mathbf{i}+13 \mathbf{j}-16 \mathbf{k}-2 \mathbf{i}+4 \mathbf{j}+4 \mathbf{k}] \\
                    & =[-41,-8 \mathbf{i}+17 \mathbf{j}-12 \mathbf{k}] .
    \end{aligned}
$$
注意：在这个计算中唯一改变的是轴向量叉乘的符号。
\end{myexample}

\begin{myexample}{四元数平方}{theoexample}
计算这个四元数的平方:
$$
    \begin{aligned}
        q     & =[2,-2 \mathbf{i}+3 \mathbf{j}-4 \mathbf{k}]                                            \\
        q^{2} & =[2,-2 \mathbf{i}+3 \mathbf{j}-4 \mathbf{k}][2,-2 \mathbf{i}+3 \mathbf{j}-4 \mathbf{k}] \\
              & =[2 \times 2-((-2) \times(-2)+3 \times 3+(-4) \times(-4))                               \\
              & +2 \times 2(-2 \mathbf{i}+3 \mathbf{j}-4 \mathbf{k})]                                   \\
              & =[-25,-8 \mathbf{i}+12 \mathbf{j}-16 \mathbf{k}]
    \end{aligned}
$$
\end{myexample}

\begin{myexample}{四元数的逆}{theoexample}
计算这个四元数的逆:
$$
    \begin{aligned}
        q       & =[2,-2 \mathbf{i}+3 \mathbf{j}-4 \mathbf{k}]              \\
        q^{*}   & =[2,2 \mathbf{i}-3 \mathbf{j}+4 \mathbf{k}]               \\
        |q|^{2} & =2^{2}+(-2)^{2}+3^{2}+(-4)^{2}=33                         \\
        q^{-1}  & =\frac{1}{33}[2,2 \mathbf{i}-3 \mathbf{j}+4 \mathbf{k}] .
    \end{aligned}
$$
\end{myexample}



\begin{thebibliography}{99}
    \bibitem{bib6-1} Hamilton, W.R.: On quaternions: or a new system of imaginaries in algebra. Phil. Mag. 3rd ser. $25(1844)$

    \bibitem{bib6-2} Hamilton, W.R.: Lectures on Quaternions. Hodges and Smith, Dublin (1853)

    \bibitem{bib6-3} Hamilton, W.R.: Elements of Quaternions (Jolly, C.J. (ed.) 2 vols.), 2nd edn. Green \& Co., London, Longmans (1899-1901)

    \bibitem{bib6-4} Tait, P.G.: An Elementary Treatise on Quaternions. Cambridge University Press, Cambridge $(1867)$

    \bibitem{bib6-5} Gauss, C.F.: Mutation des Raumes In: Carl Friedrich Gauss Werke, Achter Band, pp. 357-361, König. Gesell. Wissen. Göttingen, 1900 (1819)

    \bibitem{bib6-6} Wilson, E.B.: Vector Analysis. Yale University Press, New Haven (1901)

    \bibitem{bib6-7} Feynman, R.P.: Symmetry and physical laws. In: Feynman Lectures in Physics, vol. 1

    \bibitem{bib6-8} Altmann, S.L.: Rotations, : Quaternions and Double Groups, p. 16. Dover, New York (2005). ISBN-13: 978-0-486-44518-2

\end{thebibliography}
